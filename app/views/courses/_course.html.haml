
/ Внешний вид карточки курса для вывода в Index
.card
  .card-header
    .fa.fa-graduation-cap
    = link_to course.title, course_path(course)
  .card-body
    %small= simple_format(course.short_description)
  .card-footer
    .text-center
      -#Кнопка для подписки/ описана в course helper
      = enrollment_button(course)
      .row
      / кнопка для отзыва
      = review_button(course)
  .card-footer

    -#Кол-во подписчиков, которое считается налету ( и жрет ресурсы)
    -#Enrolments count:
    -#= course.enrollments.count
    -#Кол-во подписчиков, которое хранится в БД и обновляется
    .row
      .col-md-6
        .text-warning.fa.fa-star
        -#рейтинг курса
        = course.average_rating
        (
        .fa.fa-user-graduate
        = course.enrollments_count
        )
        .fa.fa-tasks
          -#кол-во лекций в курсе
          -# = course.lessons.count
          = course.lessons_count
      .col-md-6.text-right
        .fa.fa-chalkboard-teacher
          -#Автор курса
        = link_to course.user.username, user_path(course.user)


  -#.card-footer
  -#.card-footer
  -#  .row
  -#    .col-md-6
  -#      .fa.fa-globe-africa
  -#        -#Язык курса
  -#      = course.language
  -#    .col-md-6.text-right
  -#      .fa.fa-signal
  -#        -#Уровень курса
  -#      %small= course.level
  -#.card-footer
  -#  / дату показываем в форматированном виде
  -#  .row
  -#    .col-md-6
  -#      .far.fa-clock
  -#        -#Дата создания курса
  -#      %small= course.created_at.strftime('%d-%b-%Y')
  -#    .col-md-6.text-right
        -#.fa.fa-chalkboard-teacher
          -#Автор курса
        -# = link_to course.user.username, user_path(course.user)
  - if current_user
    - if policy(course).edit?
      .card-footer
        / добавляем кнопку для создания урока, при пересылке нужно передать ID курса в params
        - if policy(course).owner?
          = link_to "Add lesson", new_course_lesson_path(course, @lesson), class: "btn btn-primary btn-sm "
          /Кнопка редактирования будет отображаться только если есть права на редактирование
          -#if policy(course).edit?
          = link_to 'Edit', edit_course_path(course), class: "btn btn-sm btn-warning"
          -#if policy(course).edit?
          = link_to 'Destroy', course, method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-sm btn-danger"

    -#Только у админа и хозяина есть права на удаление, поэтому показываем статус Публикации только им
    - if policy(course).destroy?
      .card-footer
        - if course.published?
          .badge.badge-success Published
        -else
          .badge.badge-danger Unpublished
        - if course.approved?
          .badge.badge-success Approved
        -else
          .badge.badge-danger Unapproved

    - if policy(course).approve?
      .card-footer
        - if course.approved?
          = link_to "Unapprove", unapprove_course_path(course), method: :patch, class: "btn btn-sm btn-danger"
        -else
          = link_to "Approve", approve_course_path(course), method: :patch, class: "btn btn-sm btn-success"
